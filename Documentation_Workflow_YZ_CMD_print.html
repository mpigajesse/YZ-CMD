
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Documentation Workflow YZ-CMD</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        h1 { color: #2c3e50; border-bottom: 3px solid #3498db; padding-bottom: 10px; }
        h2 { color: #34495e; border-bottom: 2px solid #ecf0f1; padding-bottom: 5px; }
        h3 { color: #7f8c8d; }
        table { border-collapse: collapse; width: 100%; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #f2f2f2; font-weight: bold; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        code { background-color: #f4f4f4; padding: 2px 4px; border-radius: 3px; }
        pre { background-color: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; }
        blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; background-color: #ecf8ff; }
        .page-break { page-break-before: always; }
        @media print {
            body { font-size: 11pt; }
            h1 { font-size: 18pt; }
            h2 { font-size: 16pt; }
            h3 { font-size: 14pt; }
        }
    </style>
</head>
<body>
<p><h1>ğŸ—ï¸ DOCUMENTATION WORKFLOW YZ-CMD</p><br>
<p><strong>SystÃ¨me de Gestion de Commandes E-commerce<strong>  <br>
<strong>Architecture BPMN & SpÃ©cifications Techniques ComplÃ¨tes<strong></p><br>
<p>---</p><br>
<p>#<h1>ğŸ“‹ Table des MatiÃ¨res</p><br>
<p>1. [Vue d'Ensemble du SystÃ¨me](#1-vue-densemble-du-systÃ¨me)<br>
2. [Architecture Technique](#2-architecture-technique)<br>
3. [SystÃ¨me d'Authentification](#3-systÃ¨me-dauthentification)<br>
4. [Synchronisation Externe](#4-synchronisation-externe)<br>
5. [Workflow Principal des Commandes](#5-workflow-principal-des-commandes)<br>
6. [Gestion Articles et Stock](#6-gestion-articles-et-stock)<br>
7. [SystÃ¨me OpÃ©rations et Tracking](#7-systÃ¨me-opÃ©rations-et-tracking)<br>
8. [Gestion Upsells Automatique](#8-gestion-upsells-automatique)<br>
9. [Analytics et KPIs](#9-analytics-et-kpis)<br>
10. [Interfaces Utilisateur SpÃ©cialisÃ©es](#10-interfaces-utilisateur-spÃ©cialisÃ©es)<br>
11. [SÃ©curitÃ© et Middleware](#11-sÃ©curitÃ©-et-middleware)<br>
12. [ModÃ¨les de DonnÃ©es](#12-modÃ¨les-de-donnÃ©es)<br>
13. [DÃ©ploiement et Configuration](#13-dÃ©ploiement-et-configuration)</p><br>
<p>---</p><br>
<p>#<h1>1. ğŸ¯ Vue d'Ensemble du SystÃ¨me</p><br>
<p>##<h1>Description GÃ©nÃ©rale</p><br>
<p>YZ-CMD est un systÃ¨me complet de gestion de commandes e-commerce dÃ©veloppÃ© en Django, spÃ©cialement conÃ§u pour les Ã©quipes opÃ©rationnelles au Maroc. Le systÃ¨me intÃ¨gre des fonctionnalitÃ©s avancÃ©es de synchronisation, de traÃ§abilitÃ© et d'automatisation pour optimiser le processus de vente du premier contact jusqu'Ã  la livraison.</p><br>
<p>##<h1>Objectifs MÃ©tier</p><br>
<p>- <strong>Automatisation Maximum :<strong> RÃ©duction des tÃ¢ches manuelles rÃ©pÃ©titives<br>
- <strong>TraÃ§abilitÃ© ComplÃ¨te :<strong> Suivi dÃ©taillÃ© de chaque action et Ã©tat<br>
- <strong>Interfaces SpÃ©cialisÃ©es :<strong> Outils adaptÃ©s Ã  chaque rÃ´le opÃ©rationnel<br>
- <strong>Synchronisation Temps RÃ©el :<strong> IntÃ©gration avec sources externes (Google Sheets)<br>
- <strong>Analytics AvancÃ©es :<strong> KPIs de performance et tableaux de bord</p><br>
<p>##<h1>Technologies UtilisÃ©es</p><br>
<table>
<tr><th> Composant </th><th> Technologie </th><th> Version </th></tr>
<tr><td> Backend </td><td> Django </td><td> 5.1.7 </td></tr>
<tr><td> Base de DonnÃ©es </td><td> PostgreSQL/SQLite </td><td> 12+ </td></tr>
<tr><td> Frontend </td><td> HTML5, CSS3, JavaScript </td><td> - </td></tr>
<tr><td> Styling </td><td> TailwindCSS </td><td> 3.8.0 </td></tr>
<tr><td> APIs </td><td> Django REST Framework </td><td> 3.15.2 </td></tr>
<tr><td> Synchronisation </td><td> Google Sheets API </td><td> v4 </td></tr>
<tr><td> Authentification </td><td> Django Auth + Groupes </td><td> - </td></tr>
<tr><td> Monitoring </td><td> Logging intÃ©grÃ© </td><td> - </td></tr>
</table>
<p>---</p><br>
<p>#<h1>2. ğŸ›ï¸ Architecture Technique</p><br>
<p>##<h1>Structure Modulaire Django</p><br>
<p><strong>Applications Core :<strong><br>
- <code>config<code> : Configuration principale et middleware<br>
- <code>parametre<code> : Gestion utilisateurs, rÃ©gions, villes<br>
- <code>client<code> : Gestion base clients<br>
- <code>article<code> : Catalogue produits et stock<br>
- <code>commande<code> : Workflow principal des commandes</p><br>
<p><strong>Applications MÃ©tier :<strong><br>
- <code>operatConfirme<code> : Interface opÃ©rateurs confirmation<br>
- <code>operatLogistic<code> : Interface opÃ©rateurs logistique<br>
- <code>Prepacommande<code> : Interface prÃ©paration/impression<br>
- <code>synchronisation<code> : IntÃ©gration Google Sheets<br>
- <code>kpis<code> : Analytics et tableaux de bord</p><br>
<p>##<h1>Pattern MVT (Model-View-Template)</p><br>
<p><code><code><code><br>
Models (DonnÃ©es) â†” Views (Logique MÃ©tier) â†” Templates (Interface)<br>
                â†•<br>
    Middleware (SÃ©curitÃ©/Session/Validation)<br>
                â†•<br>
        APIs Externes (Google Sheets)<br>
<code><code><code></p><br>
<p>---</p><br>
<p>#<h1>3. ğŸ” SystÃ¨me d'Authentification</p><br>
<p>##<h1>Workflow d'Authentification</p><br>
<p><code><code><code><br>
Connexion Utilisateur<br>
    â†“<br>
Validation Credentials (Django Auth)<br>
    â†“<br>
VÃ©rification Profil OpÃ©rateur (type_operateur)<br>
    â†“<br>
    TYPES DISPONIBLES :<br>
    â”œâ”€â”€ ADMIN â†’ Interface Administrateur<br>
    â”œâ”€â”€ CONFIRMATION â†’ Interface Confirmation<br>
    â”œâ”€â”€ LOGISTIQUE â†’ Interface Logistique<br>
    â””â”€â”€ PREPARATION â†’ Interface PrÃ©paration<br>
    â†“<br>
Redirection Automatique + Gestion Session<br>
    â†“<br>
Middleware de Validation Continue<br>
<code><code><code></p><br>
<p>##<h1>SÃ©curitÃ© AvancÃ©e</p><br>
<p><strong>ğŸ›¡ï¸ Protections ImplÃ©mentÃ©es :<strong><br>
- <strong>Session Timeout :<strong> DÃ©connexion automatique aprÃ¨s inactivitÃ© (2h)<br>
- <strong>CSRF Protection :<strong> Protection contre les attaques cross-site<br>
- <strong>Validation Type Utilisateur :<strong> ContrÃ´le d'accÃ¨s par interface<br>
- <strong>Logging SÃ©curisÃ© :<strong> TraÃ§abilitÃ© des connexions/actions</p><br>
<p><strong>Configuration Middleware :<strong><br>
<code><code><code>python<br>
<h1>Middleware de validation utilisateur<br>
class UserTypeValidationMiddleware:<br>
    allowed_prefixes = {<br>
        'ADMIN': '/parametre/',<br>
        'CONFIRMATION': '/operateur-confirme/',<br>
        'LOGISTIQUE': '/operateur-logistique/', <br>
        'PREPARATION': '/operateur-preparation/'<br>
    }<br>
<code><code><code></p><br>
<p>---</p><br>
<p>#<h1>4. ğŸ”„ Synchronisation Externe</p><br>
<p>##<h1>IntÃ©gration Google Sheets</p><br>
<p><code><code><code><br>
Google Sheets (Source Externe)<br>
    â†“<br>
API Authentication (Service Account)<br>
    â†“<br>
Lecture Structure : Headers + Data Rows<br>
    â†“<br>
Traitement Ligne par Ligne :<br>
    â”œâ”€â”€ Parsing DonnÃ©es Client (TÃ©lÃ©phone/Nom/Adresse)<br>
    â”œâ”€â”€ Parsing Produit (Nom/Couleur/Taille/Prix)<br>
    â”œâ”€â”€ Mapping Statut â†’ Ã‰tats SystÃ¨me<br>
    â””â”€â”€ Validation OpÃ©rateur<br>
    â†“<br>
Logique Anti-Doublons :<br>
    â”œâ”€â”€ [NOUVEAU] â†’ CrÃ©ation Commande + Client + Article<br>
    â”œâ”€â”€ [EXISTANT] â†’ Mise Ã  Jour si Changements<br>
    â””â”€â”€ [DOUBLON] â†’ Skip avec Log<br>
    â†“<br>
CrÃ©ation Ã‰tats Automatique + Logs DÃ©taillÃ©s<br>
<code><code><code></p><br>
<p>##<h1>Statistiques de Synchronisation</p><br>
<table>
<tr><th> MÃ©trique </th><th> Description </th><th> UtilitÃ© </th></tr>
<tr><td> new_orders_created </td><td> Nouvelles commandes crÃ©Ã©es </td><td> Croissance volume </td></tr>
<tr><td> existing_orders_updated </td><td> Commandes existantes mises Ã  jour </td><td> Suivi modifications </td></tr>
<tr><td> duplicate_orders_found </td><td> Doublons dÃ©tectÃ©s </td><td> QualitÃ© donnÃ©es </td></tr>
<tr><td> execution_details </td><td> DÃ©tails JSON complets </td><td> Debug/Audit </td></tr>
</table>
<p>---</p><br>
<p>#<h1>5. ğŸ¯ Workflow Principal des Commandes</p><br>
<p>##<h1>Phase 1 : Affectation et Confirmation</p><br>
<p><strong>Ã‰tats :<strong> Non AffectÃ©e â†’ AffectÃ©e â†’ En Cours Confirmation â†’ ConfirmÃ©e</p><br>
<p><code><code><code><br>
PROCESSUS CONFIRMATION DÃ‰TAILLÃ‰ :</p><br>
<p>1. Affectation OpÃ©rateur Confirmation<br>
   â”œâ”€â”€ Manuelle (Admin)<br>
   â””â”€â”€ Automatique (Round-Robin)</p><br>
<p>2. Interface OpÃ©rateur Confirmation<br>
   â”œâ”€â”€ Appel TÃ©lÃ©phone Standard<br>
   â”œâ”€â”€ WhatsApp (Appel/Message/Vocal)<br>
   â””â”€â”€ SMS</p><br>
<p>3. Validation DonnÃ©es<br>
   â”œâ”€â”€ Informations Client (Nom/Tel/Adresse)<br>
   â”œâ”€â”€ DÃ©tails Produit (DisponibilitÃ©)<br>
   â””â”€â”€ Informations Livraison (Ville/Frais)</p><br>
<p>4. Enregistrement OpÃ©ration<br>
   â”œâ”€â”€ Type Communication<br>
   â”œâ”€â”€ Conclusion Libre<br>
   â”œâ”€â”€ Commentaire PrÃ©dÃ©fini<br>
   â””â”€â”€ Horodatage Automatique</p><br>
<p>5. DÃ©cision Finale<br>
   â”œâ”€â”€ [CONFIRMÃ‰E] â†’ DÃ©crÃ©mentation Stock + Transition<br>
   â”œâ”€â”€ [ERRONÃ‰E] â†’ Archivage + Motif<br>
   â”œâ”€â”€ [DOUBLON] â†’ Suppression + Log<br>
   â””â”€â”€ [ANNULÃ‰E] â†’ Ã‰tat Final + Motif<br>
<code><code><code></p><br>
<p>##<h1>Phase 2 : PrÃ©paration</p><br>
<p><strong>Ã‰tats :<strong> ConfirmÃ©e â†’ Ã€ Imprimer â†’ En PrÃ©paration â†’ PrÃ©parÃ©e</p><br>
<p><code><code><code><br>
PROCESSUS PRÃ‰PARATION DÃ‰TAILLÃ‰ :</p><br>
<p>1. Affectation Automatique OpÃ©rateur PrÃ©paration<br>
   â””â”€â”€ Transition Ã‰tat "Ã€ Imprimer"</p><br>
<p>2. Impression Documents<br>
   â”œâ”€â”€ Ã‰tiquettes ExpÃ©dition (Adresse/Client)<br>
   â”œâ”€â”€ Tickets PrÃ©paration (Articles/QuantitÃ©s)<br>
   â””â”€â”€ Bons de Commande (RÃ©capitulatif)</p><br>
<p>3. PrÃ©paration Physique<br>
   â”œâ”€â”€ Validation Ã‰tat "En PrÃ©paration"<br>
   â”œâ”€â”€ Collecte Articles selon Ticket<br>
   â”œâ”€â”€ VÃ©rification QualitÃ©/QuantitÃ©<br>
   â””â”€â”€ Emballage Final</p><br>
<p>4. Validation PrÃ©paration<br>
   â”œâ”€â”€ ContrÃ´le Final OpÃ©rateur<br>
   â”œâ”€â”€ Transition Ã‰tat "PrÃ©parÃ©e"<br>
   â””â”€â”€ DÃ©clenchement Automatique RÃ©partition Livraison<br>
<code><code><code></p><br>
<p>##<h1>Phase 3 : Livraison</p><br>
<p><strong>Ã‰tats :<strong> PrÃ©parÃ©e â†’ En Cours Livraison â†’ LivrÃ©e/ReportÃ©e/RetournÃ©e</p><br>
<p>> <strong>ğŸš€ AUTOMATISATION CLÃ‰ :<strong> La rÃ©partition automatique des commandes prÃ©parÃ©es vers les opÃ©rateurs logistiques utilise un algorithme Round-Robin pour Ã©quilibrer la charge de travail.</p><br>
<p>##<h1>Ã‰tats des Commandes - RÃ©fÃ©rence ComplÃ¨te</p><br>
<table>
<tr><th> Ã‰tat </th><th> Description </th><th> Transition Suivante </th></tr>
<tr><td> Non AffectÃ©e </td><td> Commande crÃ©Ã©e mais non assignÃ©e </td><td> AffectÃ©e </td></tr>
<tr><td> AffectÃ©e </td><td> AssignÃ©e Ã  un opÃ©rateur confirmation </td><td> En Cours Confirmation </td></tr>
<tr><td> En Cours Confirmation </td><td> En cours de traitement par opÃ©rateur </td><td> ConfirmÃ©e/ErronÃ©e/AnnulÃ©e </td></tr>
<tr><td> ConfirmÃ©e </td><td> ValidÃ©e et stock dÃ©crÃ©mentÃ© </td><td> Ã€ Imprimer </td></tr>
<tr><td> Ã€ Imprimer </td><td> PrÃªte pour impression Ã©tiquettes </td><td> En PrÃ©paration </td></tr>
<tr><td> En PrÃ©paration </td><td> Articles en cours de prÃ©paration </td><td> PrÃ©parÃ©e </td></tr>
<tr><td> PrÃ©parÃ©e </td><td> PrÃªte pour livraison </td><td> En Cours Livraison </td></tr>
<tr><td> En Cours Livraison </td><td> AssignÃ©e Ã  opÃ©rateur logistique </td><td> LivrÃ©e/ReportÃ©e/RetournÃ©e </td></tr>
<tr><td> LivrÃ©e </td><td> Livraison rÃ©ussie - Ã‰tat final </td><td> - </td></tr>
<tr><td> ReportÃ©e </td><td> Livraison reportÃ©e </td><td> En Cours Livraison </td></tr>
<tr><td> RetournÃ©e </td><td> Retour client - Ã‰tat final </td><td> - </td></tr>
<tr><td> ErronÃ©e </td><td> Erreur dans les donnÃ©es - Ã‰tat final </td><td> - </td></tr>
<tr><td> AnnulÃ©e </td><td> Commande annulÃ©e - Ã‰tat final </td><td> - </td></tr>
</table>
<p>---</p><br>
<p>#<h1>6. ğŸ“¦ Gestion Articles et Stock</p><br>
<p>##<h1>ModÃ¨le Article AvancÃ©</p><br>
<table>
<tr><th> Champ </th><th> Type </th><th> Description </th><th> Utilisation </th></tr>
<tr><td> nom, couleur, pointure </td><td> ClÃ© Unique </td><td> Identification article </td><td> Contrainte unicitÃ© </td></tr>
<tr><td> prix_unitaire </td><td> Decimal </td><td> Prix de base </td><td> Calculs standards </td></tr>
<tr><td> prix_upsell_1-4 </td><td> Decimal </td><td> Prix par quantitÃ© </td><td> Logique upsells </td></tr>
<tr><td> qte_disponible </td><td> Integer </td><td> Stock temps rÃ©el </td><td> Gestion automatique </td></tr>
<tr><td> phase </td><td> Choice </td><td> EN_COURS/LIQUIDATION/EN_TEST </td><td> StratÃ©gie commerciale </td></tr>
</table>
<p>##<h1>SystÃ¨me de Mouvements Stock</p><br>
<p><code><code><code><br>
TYPES MOUVEMENTS AUTOMATIQUES :</p><br>
<p>â”œâ”€â”€ ENTRÃ‰E<br>
â”‚   â”œâ”€â”€ RÃ©approvisionnement Manuel<br>
â”‚   â”œâ”€â”€ Retour Client (Annulation)<br>
â”‚   â””â”€â”€ Ajustement Inventaire (+)</p><br>
<p>â”œâ”€â”€ SORTIE  <br>
â”‚   â”œâ”€â”€ Confirmation Commande (Automatique)<br>
â”‚   â”œâ”€â”€ Perte/Casse<br>
â”‚   â””â”€â”€ Ajustement Inventaire (-)</p><br>
<p>â””â”€â”€ TRAÃ‡ABILITÃ‰<br>
    â”œâ”€â”€ OpÃ©rateur Responsable<br>
    â”œâ”€â”€ Commande AssociÃ©e (si applicable)<br>
    â”œâ”€â”€ Commentaire Justificatif<br>
    â””â”€â”€ Horodatage PrÃ©cis<br>
<code><code><code></p><br>
<p>##<h1>Alertes Stock Intelligent</p><br>
<p>- <strong>Stock Faible :<strong> Alerte < 5 unitÃ©s (paramÃ©trable)<br>
- <strong>Rupture Stock :<strong> Alerte = 0 unitÃ©s<br>
- <strong>Validation Confirmation :<strong> VÃ©rification stock avant validation<br>
- <strong>RÃ©servation Temporaire :<strong> Stock "gelÃ©" pendant confirmation</p><br>
<p>---</p><br>
<p>#<h1>7. âš™ï¸ SystÃ¨me OpÃ©rations et Tracking</p><br>
<p>##<h1>Types d'OpÃ©rations SupportÃ©es</p><br>
<p><strong>ğŸ“ Communications Client :<strong><br>
- <strong>Appel TÃ©lÃ©phone :<strong> Communication standard<br>
- <strong>WhatsApp Appel :<strong> Appel via WhatsApp<br>
- <strong>WhatsApp Message :<strong> Message texte WhatsApp<br>
- <strong>WhatsApp Vocal :<strong> Message vocal WhatsApp<br>
- <strong>SMS :<strong> Message texte court</p><br>
<p><strong>ğŸ”§ OpÃ©rations Techniques :<strong><br>
- <strong>Modification :<strong> Changement donnÃ©es commande<br>
- <strong>ProblÃ¨me SignalÃ© :<strong> Issue technique/logistique<br>
- <strong>Renvoi PrÃ©paration :<strong> Retour en prÃ©paration</p><br>
<p>##<h1>Commentaires PrÃ©dÃ©finis</p><br>
<p><code><code><code><br>
COMMENTAIRES STANDARDISÃ‰S :</p><br>
<p>â”œâ”€â”€ Ã‰tats Client<br>
â”‚   â”œâ”€â”€ "Client hÃ©sitant"<br>
â”‚   â”œâ”€â”€ "Client intÃ©ressÃ©" <br>
â”‚   â”œâ”€â”€ "Client non intÃ©ressÃ©"<br>
â”‚   â””â”€â”€ "Client non joignable"</p><br>
<p>â”œâ”€â”€ Statuts Commande<br>
â”‚   â”œâ”€â”€ "Commande AnnulÃ©e"<br>
â”‚   â”œâ”€â”€ "Commande reportÃ©e"<br>
â”‚   â””â”€â”€ "Article non disponible"</p><br>
<p>â””â”€â”€ Suivi Automatique<br>
    â”œâ”€â”€ Horodatage PrÃ©cis<br>
    â”œâ”€â”€ OpÃ©rateur Responsable<br>
    â””â”€â”€ Historique Complet Consultable<br>
<code><code><code></p><br>
<p>---</p><br>
<p>#<h1>8. ğŸ’° Gestion Upsells Automatique</p><br>
<p>##<h1>Logique de Calcul Automatique</p><br>
<p><code><code><code><br>
SYSTÃˆME COMPTEUR UPSELL :</p><br>
<p>Article marquÃ© isUpsell = True<br>
    â†“<br>
Compteur Commande (initialisÃ© Ã  0)<br>
    â†“<br>
    AJOUT/MODIFICATION ARTICLES :<br>
    â”œâ”€â”€ 1 Article â†’ Prix Standard (compteur +0)<br>
    â”œâ”€â”€ 2 Articles â†’ Prix Upsell 1 (compteur +1)  <br>
    â”œâ”€â”€ 3 Articles â†’ Prix Upsell 2 (compteur +2)<br>
    â””â”€â”€ 4+ Articles â†’ Prix Upsell 3/4 (compteur +3/4)<br>
    â†“<br>
Recalcul Automatique Total Commande<br>
    â”œâ”€â”€ Nouveau Prix Ã— QuantitÃ©<br>
    â”œâ”€â”€ + Frais Livraison (selon ville)<br>
    â””â”€â”€ Sauvegarde Transparente<br>
<code><code><code></p><br>
<p>##<h1>Exemple Concret de Calcul</p><br>
<table>
<tr><th> QuantitÃ© </th><th> Prix Unitaire </th><th> Compteur </th><th> Total Articles </th><th> Frais Livraison </th><th> Total Final </th></tr>
<tr><td> 1 </td><td> 299 MAD </td><td> 0 </td><td> 299 MAD </td><td> 25 MAD </td><td> 324 MAD </td></tr>
<tr><td> 2 </td><td> 249 MAD </td><td> 1 </td><td> 498 MAD </td><td> 25 MAD </td><td> 523 MAD </td></tr>
<tr><td> 3 </td><td> 219 MAD </td><td> 2 </td><td> 657 MAD </td><td> 25 MAD </td><td> 682 MAD </td></tr>
<tr><td> 4+ </td><td> 199 MAD </td><td> 3/4 </td><td> 796+ MAD </td><td> 25 MAD </td><td> 821+ MAD </td></tr>
</table>
<p>---</p><br>
<p>#<h1>9. ğŸ“ˆ Analytics et KPIs</p><br>
<p>##<h1>Dashboard 360Â° - MÃ©triques ClÃ©s</p><br>
<p><strong>KPIs Temps RÃ©el :<strong><br>
- <strong>Performance OpÃ©rateurs :<strong> Temps traitement moyen, taux conversion<br>
- <strong>Ã‰volution CA :<strong> Chiffre d'affaires par pÃ©riode<br>
- <strong>Top ModÃ¨les :<strong> Articles les plus vendus<br>
- <strong>Performance RÃ©gions :<strong> Ventes par zone gÃ©ographique<br>
- <strong>Statistiques Clients :<strong> Acquisition, fidÃ©lisation<br>
- <strong>Vue Quantitative :<strong> Volumes, stocks, mouvements<br>
- <strong>Taux Livraison :<strong> Success rate livraisons<br>
- <strong>Analyse Temporelle :<strong> Patterns temporels</p><br>
<p>##<h1>Calculs Automatiques</p><br>
<p><code><code><code><br>
MÃ‰TRIQUES BUSINESS EN TEMPS RÃ‰EL :</p><br>
<p>â”œâ”€â”€ Performance OpÃ©rateurs<br>
â”‚   â”œâ”€â”€ Temps Moyen par Commande<br>
â”‚   â”œâ”€â”€ Nombre Commandes TraitÃ©es/Jour<br>
â”‚   â”œâ”€â”€ Taux de Conversion (ConfirmÃ©e/AffectÃ©e)<br>
â”‚   â””â”€â”€ Distribution Temps de Traitement</p><br>
<p>â”œâ”€â”€ MÃ©triques Business<br>
â”‚   â”œâ”€â”€ CA Total/PÃ©riode (Jour/Semaine/Mois)<br>
â”‚   â”œâ”€â”€ Panier Moyen Client<br>
â”‚   â”œâ”€â”€ Taux Retour/Annulation<br>
â”‚   â””â”€â”€ Progression Objectifs</p><br>
<p>â””â”€â”€ Analyse OpÃ©rationnelle<br>
    â”œâ”€â”€ Stock Moyen par Article<br>
    â”œâ”€â”€ Rotation Stock (Velocity)<br>
    â”œâ”€â”€ Temps Cycle Commande ComplÃ¨te<br>
    â””â”€â”€ Goulots d'Ã‰tranglement IdentifiÃ©s<br>
<code><code><code></p><br>
<p>##<h1>Exports et Rapports</p><br>
<p>- <strong>Export Excel :<strong> DonnÃ©es dÃ©taillÃ©es performance opÃ©rateurs<br>
- <strong>Export CSV :<strong> DonnÃ©es brutes pour analyses externes<br>
- <strong>Rapports Automatiques :<strong> SynthÃ¨ses quotidiennes/hebdomadaires<br>
- <strong>API REST :<strong> IntÃ©gration systÃ¨mes tiers</p><br>
<p>---</p><br>
<p>#<h1>10. ğŸ’» Interfaces Utilisateur SpÃ©cialisÃ©es</p><br>
<p>##<h1>Interface Administrateur</p><br>
<p><strong>ğŸ”§ FonctionnalitÃ©s Admin :<strong><br>
- Gestion globale utilisateurs et opÃ©rateurs<br>
- Configuration synchronisation Google Sheets<br>
- Monitoring systÃ¨me et logs<br>
- ParamÃ©trage rÃ©gions/villes/frais livraison<br>
- Dashboard KPIs 360Â°<br>
- Gestion articles, stock et promotions<br>
- Diagnostic et correction donnÃ©es</p><br>
<p>##<h1>Interface OpÃ©rateur Confirmation</p><br>
<p><strong>ğŸ“ Outils Confirmation :<strong><br>
- Liste commandes affectÃ©es (temps rÃ©el)<br>
- Interface appels optimisÃ©e (Tel/WhatsApp/SMS)<br>
- Commentaires prÃ©dÃ©finis rapides<br>
- Validation informations client/livraison<br>
- Gestion stock en temps rÃ©el<br>
- Historique opÃ©rations personnelles<br>
- Statistiques performance individuelles</p><br>
<p>##<h1>Interface OpÃ©rateur Logistique</p><br>
<p><strong>ğŸšš Gestion Livraisons :<strong><br>
- Vue commandes prÃ©parÃ©es par rÃ©gion<br>
- CrÃ©ation et gestion envois<br>
- Planification tournÃ©es livraison<br>
- Gestion problÃ¨mes/reports/retours<br>
- Service aprÃ¨s-vente intÃ©grÃ©<br>
- Suivi temps rÃ©el livraisons<br>
- Interface mobile-friendly</p><br>
<p>##<h1>Interface OpÃ©rateur PrÃ©paration</p><br>
<p><strong>ğŸ“¦ PrÃ©paration & Impression :<strong><br>
- File d'attente commandes Ã  traiter<br>
- Impression Ã©tiquettes/tickets optimisÃ©e<br>
- Interface prÃ©paration guidÃ©e<br>
- ContrÃ´le qualitÃ© intÃ©grÃ©<br>
- Gestion modifications derniÃ¨re minute<br>
- Statistiques productivitÃ©<br>
- Alertes stock insuffisant</p><br>
<p>---</p><br>
<p>#<h1>11. ğŸ›¡ï¸ SÃ©curitÃ© et Middleware</p><br>
<p>##<h1>Stack SÃ©curitÃ© ComplÃ¨te</p><br>
<p><code><code><code><br>
COUCHES PROTECTION :</p><br>
<p>1. Middleware Django Standard<br>
   â”œâ”€â”€ SecurityMiddleware (HTTPS, Headers)<br>
   â”œâ”€â”€ SessionMiddleware (Gestion sessions)<br>
   â”œâ”€â”€ CsrfViewMiddleware (Protection CSRF)<br>
   â””â”€â”€ AuthenticationMiddleware (Auth users)</p><br>
<p>2. Middleware PersonnalisÃ© YZ-CMD<br>
   â”œâ”€â”€ SessionTimeoutMiddleware (Timeout auto)<br>
   â”œâ”€â”€ UserTypeValidationMiddleware (ContrÃ´le accÃ¨s)<br>
   â””â”€â”€ CSRFDebugMiddleware (Debug CSRF dev)</p><br>
<p>3. ContrÃ´les Applicatifs<br>
   â”œâ”€â”€ Validation type utilisateur par route<br>
   â”œâ”€â”€ VÃ©rification permissions par action<br>
   â”œâ”€â”€ Logging sÃ©curisÃ© toutes actions<br>
   â””â”€â”€ Audit trail complet<br>
<code><code><code></p><br>
<p>##<h1>Gestion Sessions AvancÃ©e</p><br>
<p><strong>ğŸ” Configuration Sessions :<strong><br>
- <strong>DurÃ©e :<strong> 24h avec refresh automatique<br>
- <strong>Timeout InactivitÃ© :<strong> 2h dÃ©connexion auto<br>
- <strong>Cookie SÃ©curisÃ© :<strong> HttpOnly + Secure en prod<br>
- <strong>Nom PersonnalisÃ© :<strong> yz_cmd_sessionid<br>
- <strong>Nettoyage Auto :<strong> Cleanup sessions expirÃ©es</p><br>
<p>##<h1>Protection CSRF RenforcÃ©e</p><br>
<p><code><code><code>python<br>
<h1>Configuration CSRF personnalisÃ©e<br>
CSRF_COOKIE_NAME = 'yz_csrf_token'<br>
CSRF_COOKIE_AGE = 31449600  <h1>1 an<br>
CSRF_TRUSTED_ORIGINS = [<br>
    'http://localhost:8000',<br>
    'http://192.168.*:8000',  <h1>RÃ©seau local<br>
]<br>
<code><code><code></p><br>
<p>---</p><br>
<p>#<h1>12. ğŸ—ƒï¸ ModÃ¨les de DonnÃ©es</p><br>
<p>##<h1>Relations Principales</p><br>
<p><code><code><code><br>
SCHÃ‰MA RELATIONNEL :</p><br>
<p>User (Django) â†â†’ Operateur (1:1)<br>
                     â†“<br>
Client â†’ Commande â† Ville â† Region  <br>
   â†“        â†“        â†“<br>
   â””â†’ Panier â†’ Article<br>
            â†“<br>
      EtatCommande â† EnumEtatCmd<br>
            â†“           â†‘<br>
        Operation â†’ Operateur<br>
            â†“<br>
      MouvementStock<br>
<code><code><code></p><br>
<p>##<h1>ModÃ¨les Critiques</p><br>
<table>
<tr><th> ModÃ¨le </th><th> ResponsabilitÃ© </th><th> Relations ClÃ©s </th><th> Contraintes </th></tr>
<tr><td> Commande </td><td> EntitÃ© centrale workflow </td><td> Client, Ville, Panier, Ã‰tats </td><td> num_cmd unique, total â‰¥ 0 </td></tr>
<tr><td> EtatCommande </td><td> Historique transitions </td><td> Commande, EnumEtatCmd, Operateur </td><td> date_debut â‰¤ date_fin </td></tr>
<tr><td> Article </td><td> Catalogue + Stock </td><td> Panier, MouvementStock </td><td> (nom,couleur,pointure) unique </td></tr>
<tr><td> Operation </td><td> TraÃ§abilitÃ© actions </td><td> Commande, Operateur </td><td> Horodatage automatique </td></tr>
</table>
<p>##<h1>Contraintes d'IntÃ©gritÃ©</p><br>
<p>- <strong>UnicitÃ© :<strong> Region.nom_region, Client.numero_tel, Article(nom+couleur+pointure)<br>
- <strong>Valeurs Positives :<strong> Article.prix_unitaire > 0, qte_disponible â‰¥ 0<br>
- <strong>CohÃ©rence Temporelle :<strong> EtatCommande dates cohÃ©rentes<br>
- <strong>IntÃ©gritÃ© RÃ©fÃ©rentielle :<strong> CASCADE/SET_NULL selon logique mÃ©tier</p><br>
<p>---</p><br>
<p>#<h1>13. ğŸš€ DÃ©ploiement et Configuration</p><br>
<p>##<h1>PrÃ©requis SystÃ¨me</p><br>
<table>
<tr><th> Composant </th><th> Version Minimum </th><th> Notes </th></tr>
<tr><td> Python </td><td> 3.9+ </td><td> Avec pip installÃ© </td></tr>
<tr><td> Django </td><td> 5.1.7 </td><td> Framework principal </td></tr>
<tr><td> PostgreSQL </td><td> 12+ </td><td> Base de donnÃ©es (ou SQLite pour dev) </td></tr>
<tr><td> Node.js </td><td> 16+ </td><td> Pour TailwindCSS </td></tr>
<tr><td> Google API </td><td> Service Account </td><td> ClÃ©s API configurÃ©es </td></tr>
</table>
<p>##<h1>Configuration Environnement</p><br>
<p><code><code><code>bash<br>
<h1>Variables d'environnement requises<br>
DB_NAME=yzcmd_db<br>
DB_USER=postgres<br>
DB_PASSWORD=your_password<br>
DB_HOST=localhost<br>
DB_PORT=5432<br>
GOOGLE_SHEET_URL=https://docs.google.com/spreadsheets/...<br>
SECRET_KEY=your-secret-key<br>
DEBUG=False<br>
<code><code><code></p><br>
<p>##<h1>SÃ©quence de DÃ©ploiement</p><br>
<p><code><code><code>bash<br>
SÃ‰QUENCE DÃ‰PLOIEMENT :</p><br>
<p>1. Installation Dependencies<br>
   pip install -r requirements.txt</p><br>
<p>2. Configuration Base de DonnÃ©es  <br>
   python manage.py makemigrations<br>
   python manage.py migrate</p><br>
<p>3. CrÃ©ation Superutilisateur<br>
   python manage.py createsuperuser</p><br>
<p>4. GÃ©nÃ©ration OpÃ©rateurs Test<br>
   python generate_operators.py</p><br>
<p>5. Import DonnÃ©es Initiales<br>
   python import_regions_villes.py<br>
   python import_articles.py</p><br>
<p>6. Lancement Serveur<br>
   python manage.py runserver 0.0.0.0:8000<br>
<code><code><code></p><br>
<p>##<h1>Fichiers Configuration Critiques</p><br>
<p>- <strong>credentials.json :<strong> Service Account Google API<br>
- <strong>requirements.txt :<strong> Dependencies Python complÃ¨tes<br>
- <strong>settings.py :<strong> Configuration Django personnalisÃ©e<br>
- <strong>.env :<strong> Variables environnement sensibles</p><br>
<p>> <strong>ğŸ”¥ ATTENTION :<strong> Assurez-vous que credentials.json est configurÃ© avec les bonnes permissions Google Sheets API et que les URLs CORS sont correctement dÃ©finies pour votre environnement de production.</p><br>
<p>---</p><br>
<p>#<h1>ğŸ“„ Conclusion</p><br>
<p><strong>YZ-CMD<strong> reprÃ©sente une solution complÃ¨te et moderne de gestion de commandes e-commerce, optimisÃ©e pour les opÃ©rations au Maroc. Le systÃ¨me combine :</p><br>
<p>- <strong>Automatisation intelligente<strong> des processus mÃ©tier<br>
- <strong>Interfaces spÃ©cialisÃ©es<strong> pour chaque rÃ´le opÃ©rationnel  <br>
- <strong>TraÃ§abilitÃ© exhaustive<strong> de toutes les actions<br>
- <strong>Analytics en temps rÃ©el<strong> pour le pilotage<br>
- <strong>SÃ©curitÃ© renforcÃ©e<strong> et conformitÃ©</p><br>
<p>Cette architecture modulaire et extensible permet une adaptation facile aux Ã©volutions des besoins mÃ©tier tout en maintenant la performance et la fiabilitÃ© requises pour un environnement de production.</p><br>
<p>---</p><br>
<p><strong>YZ-CMD<strong> - SystÃ¨me de Gestion de Commandes E-commerce  <br>
Documentation technique complÃ¨te - Version 1.0  <br>
GÃ©nÃ©rÃ© le : $(date) </p></body></html>