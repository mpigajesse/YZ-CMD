{% for commande in page_obj %}
<tr class="hover:bg-gray-50 transition-colors">
    <td class="px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900 border-r" style="border-color: var(--admin-light-accent);">
        {{ commande.id_yz }}
    </td>
    <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500 border-r" style="border-color: var(--admin-light-accent);">
        {{ commande.num_cmd|default:"-" }}
    </td>
    <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-900 border-r" style="border-color: var(--admin-light-accent);">
        {% if commande.client %}
            <div>
                <div class="font-medium">{{ commande.client.nom }} {{ commande.client.prenom }}</div>
                <div class="text-gray-500">{{ commande.client.numero_tel }}</div>
            </div>
        {% else %}
            <span class="text-gray-400">Client non défini</span>
        {% endif %}
    </td>
    <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500 border-r" style="border-color: var(--admin-light-accent);">
        {{ commande.date_cmd|date:"d/m/Y" }}
    </td>
    <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500 border-r" style="border-color: var(--admin-light-accent);">
        {% if commande.ville %}
            {{ commande.ville.nom }}
        {% else %}
            {{ commande.ville_init|default:"Non spécifiée" }}
        {% endif %}
    </td>
    <td class="px-4 py-4 whitespace-nowrap text-sm font-medium text-green-600 border-r" style="border-color: var(--admin-light-accent);">
        {{ commande.total_cmd|floatformat:2 }} DH
    </td>
    <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500 border-r" style="border-color: var(--admin-light-accent);">
        {% if commande.etat_actuel %}
            {% if commande.etat_actuel.enum_etat.libelle == 'À imprimer' %}
                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-amber-100 text-amber-800">
                    <i class="fas fa-print mr-1"></i>
                    {{ commande.etat_actuel.enum_etat.libelle }}
                </span>
            {% elif commande.etat_actuel.enum_etat.libelle == 'En préparation' %}
                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                    <i class="fas fa-boxes mr-1"></i>
                    {{ commande.etat_actuel.enum_etat.libelle }}
                </span>
            {% else %}
                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                    <i class="fas fa-cogs mr-1"></i>
                    {{ commande.etat_actuel.enum_etat.libelle }}
                </span>
            {% endif %}
        {% else %}
            <span class="text-gray-400">Non défini</span>
        {% endif %}
    </td>
    <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500 border-r" style="border-color: var(--admin-light-accent);">
        {% if commande.etat_actuel and commande.etat_actuel.operateur %}
            <div class="flex items-center space-x-2">
                <div class="w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center">
                    <i class="fas fa-user text-orange-600 text-sm"></i>
                </div>
                <div>
                    <div class="font-medium text-gray-900">{{ commande.etat_actuel.operateur.nom }}</div>
                    <div class="text-xs text-gray-500">{{ commande.etat_actuel.operateur.type_operateur }}</div>
                </div>
            </div>
        {% else %}
            <span class="text-gray-400">Non affectée</span>
        {% endif %}
    </td>
    <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500 border-r" style="border-color: var(--admin-light-accent);">
        {% if commande.etat_actuel %}
            {% if commande.etat_actuel.enum_etat.libelle == 'À imprimer' %}
                <div class="flex items-center space-x-2">
                    <div class="w-2 h-2 bg-amber-500 rounded-full"></div>
                    <span class="text-amber-600 font-medium">En attente d'impression</span>
                </div>
            {% elif commande.etat_actuel.enum_etat.libelle == 'En préparation' %}
                <div class="flex items-center space-x-2">
                    <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                    <span class="text-blue-600 font-medium">En cours de préparation</span>
                </div>
            {% else %}
                <div class="flex items-center space-x-2">
                    <div class="w-2 h-2 bg-gray-500 rounded-full"></div>
                    <span class="text-gray-600 font-medium">En traitement</span>
                </div>
            {% endif %}
        {% else %}
            <div class="flex items-center space-x-2">
                <div class="w-2 h-2 bg-yellow-500 rounded-full"></div>
                <span class="text-yellow-600 font-medium">En attente</span>
            </div>
        {% endif %}
    </td>
    <td class="px-4 py-4 whitespace-nowrap text-center">
        <div class="flex justify-center space-x-2">
            <a href="{% url 'commande:detail' commande.pk %}" 
               class="px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded transition-colors">
                <i class="fas fa-eye mr-1"></i>
                Détails
            </a>
        </div>
    </td>
</tr>
{% endfor %}
