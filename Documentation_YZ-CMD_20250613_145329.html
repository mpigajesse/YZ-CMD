
    <!DOCTYPE html>
    <html lang="fr">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Documentation YZ-CMD - COD$uite Team</title>
        
    <style>
        @page {
            size: A4;
            margin: 2.5cm 2cm;
            @top-center {
                content: "Documentation YZ-CMD - COD$uite Team";
                font-size: 10px;
                color: #666;
                font-family: 'Segoe UI', sans-serif;
            }
            @bottom-center {
                content: "Page " counter(page);
                font-size: 10px;
                color: #666;
                font-family: 'Segoe UI', sans-serif;
            }
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            font-size: 11px;
        }
        
        h1 {
            color: #2563eb;
            border-bottom: 3px solid #2563eb;
            padding-bottom: 10px;
            page-break-before: always;
            font-size: 24px;
            margin-top: 0;
        }
        
        h1:first-child {
            page-break-before: avoid;
            margin-top: 20px;
        }
        
        h2 {
            color: #1e40af;
            border-bottom: 2px solid #93c5fd;
            padding-bottom: 5px;
            margin-top: 30px;
            font-size: 18px;
        }
        
        h3 {
            color: #1e3a8a;
            margin-top: 25px;
            font-size: 16px;
        }
        
        h4 {
            color: #1e40af;
            margin-top: 20px;
            font-size: 14px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 10px;
            page-break-inside: avoid;
        }
        
        th, td {
            border: 1px solid #d1d5db;
            padding: 6px 8px;
            text-align: left;
            vertical-align: top;
        }
        
        th {
            background-color: #f3f4f6;
            font-weight: bold;
            color: #374151;
        }
        
        tr:nth-child(even) {
            background-color: #f9fafb;
        }
        
        code {
            background-color: #f1f5f9;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 10px;
            color: #1e40af;
        }
        
        pre {
            background-color: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 5px;
            padding: 12px;
            overflow-x: auto;
            font-size: 10px;
            page-break-inside: avoid;
        }
        
        blockquote {
            border-left: 4px solid #3b82f6;
            margin: 15px 0;
            padding-left: 15px;
            color: #4b5563;
            font-style: italic;
        }
        
        ul, ol {
            margin: 10px 0;
            padding-left: 20px;
        }
        
        li {
            margin: 3px 0;
        }
        
        .warning {
            background-color: #fef3c7;
            border: 1px solid #f59e0b;
            border-radius: 5px;
            padding: 10px;
            margin: 15px 0;
            page-break-inside: avoid;
        }
        
        .info {
            background-color: #dbeafe;
            border: 1px solid #3b82f6;
            border-radius: 5px;
            padding: 10px;
            margin: 15px 0;
            page-break-inside: avoid;
        }
        
        .cover-page {
            text-align: center;
            page-break-after: always;
            margin-top: 100px;
        }
        
        .cover-title {
            font-size: 32px;
            color: #2563eb;
            margin-bottom: 20px;
            font-weight: bold;
        }
        
        .cover-subtitle {
            font-size: 18px;
            color: #1e40af;
            margin-bottom: 40px;
        }
        
        .cover-info {
            font-size: 14px;
            color: #6b7280;
            margin-top: 60px;
        }
    </style>
    
    </head>
    <body>
        <div class="cover-page">
            <div class="cover-title">Documentation YZ-CMD</div>
            <div class="cover-subtitle">Système de Gestion de Commandes</div>
            <div class="cover-info">
                <p><strong>COD$uite Team</strong></p>
                <p>Version 2.0</p>
                <p>Crée le 13/06/2025 à Casablanca</p>
            </div>
        </div>
        
        <h1 id="documentation-des-modeles-projet-yz-cmd">Documentation des Modèles - Projet YZ-CMD</h1>

<h2 id="vue-densemble">Vue d'ensemble</h2>

<p>Ce document présente la structure complète de la base de données du projet YZ-CMD, un système de gestion de commandes avec interfaces séparées pour administrateurs, opérateurs de confirmation et opérateurs logistiques.</p>

<hr />

<h2 id="1-application-parametre">1. Application <code>parametre</code></h2>

<h3 id="11-modele-region">1.1 Modèle <code>Region</code></h3>

<p><strong>Description :</strong> Gestion des régions géographiques</p>

<table>
<thead>
<tr>
  <th>Champ</th>
  <th>Type</th>
  <th>Contraintes</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><code>id</code></td>
  <td>AutoField</td>
  <td>PK, Auto-increment</td>
  <td>Clé primaire automatique</td>
</tr>
<tr>
  <td><code>nom_region</code></td>
  <td>CharField(100)</td>
  <td>Unique, Required</td>
  <td>Nom de la région</td>
</tr>
</tbody>
</table>

<p><strong>Meta :</strong>
- <code>verbose_name</code> : "Région"
- <code>verbose_name_plural</code> : "Régions"
- <code>ordering</code> : ['nom_region']</p>

<p><strong>Relations :</strong>
- <code>villes</code> ← <code>Ville</code> (One-to-Many)</p>

<hr />

<h3 id="12-modele-ville">1.2 Modèle <code>Ville</code></h3>

<p><strong>Description :</strong> Gestion des villes avec informations de livraison</p>

<table>
<thead>
<tr>
  <th>Champ</th>
  <th>Type</th>
  <th>Contraintes</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><code>id</code></td>
  <td>AutoField</td>
  <td>PK, Auto-increment</td>
  <td>Clé primaire automatique</td>
</tr>
<tr>
  <td><code>nom</code></td>
  <td>CharField(100)</td>
  <td>Required</td>
  <td>Nom de la ville</td>
</tr>
<tr>
  <td><code>frais_livraison</code></td>
  <td>FloatField</td>
  <td>Required</td>
  <td>Coût de livraison</td>
</tr>
<tr>
  <td><code>frequence_livraison</code></td>
  <td>CharField(50)</td>
  <td>Required</td>
  <td>Fréquence de livraison</td>
</tr>
<tr>
  <td><code>region</code></td>
  <td>ForeignKey(Region)</td>
  <td>CASCADE, Required</td>
  <td>Région de rattachement</td>
</tr>
</tbody>
</table>

<p><strong>Meta :</strong>
- <code>verbose_name</code> : "Ville"
- <code>verbose_name_plural</code> : "Villes"
- <code>ordering</code> : ['nom']
- <code>unique_together</code> : ['nom', 'region'] (Une ville unique par région)</p>

<p><strong>Relations :</strong>
- <code>region</code> → <code>Region</code> (Many-to-One)
- <code>commandes</code> ← <code>Commande</code> (One-to-Many)</p>

<hr />

<h3 id="13-modele-operateur">1.3 Modèle <code>Operateur</code></h3>

<p><strong>Description :</strong> Profils des opérateurs du système</p>

<table>
<thead>
<tr>
  <th>Champ</th>
  <th>Type</th>
  <th>Contraintes</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><code>id</code></td>
  <td>AutoField</td>
  <td>PK, Auto-increment</td>
  <td>Clé primaire automatique</td>
</tr>
<tr>
  <td><code>user</code></td>
  <td>OneToOneField(User)</td>
  <td>CASCADE, Required</td>
  <td>Utilisateur Django associé</td>
</tr>
<tr>
  <td><code>nom</code></td>
  <td>CharField(100)</td>
  <td>Required</td>
  <td>Nom de famille</td>
</tr>
<tr>
  <td><code>prenom</code></td>
  <td>CharField(100)</td>
  <td>Required</td>
  <td>Prénom</td>
</tr>
<tr>
  <td><code>mail</code></td>
  <td>EmailField</td>
  <td>Required</td>
  <td>Adresse email</td>
</tr>
<tr>
  <td><code>type_operateur</code></td>
  <td>CharField(20)</td>
  <td>Choices, Default='CONFIRMATION'</td>
  <td>Type d'opérateur</td>
</tr>
<tr>
  <td><code>photo</code></td>
  <td>ImageField</td>
  <td>Optional</td>
  <td>Photo de profil</td>
</tr>
<tr>
  <td><code>adresse</code></td>
  <td>TextField</td>
  <td>Optional</td>
  <td>Adresse complète</td>
</tr>
<tr>
  <td><code>telephone</code></td>
  <td>CharField(20)</td>
  <td>Optional</td>
  <td>Numéro de téléphone</td>
</tr>
<tr>
  <td><code>date_creation</code></td>
  <td>DateTimeField</td>
  <td>Auto-now-add</td>
  <td>Date de création</td>
</tr>
<tr>
  <td><code>date_modification</code></td>
  <td>DateTimeField</td>
  <td>Auto-now</td>
  <td>Date de modification</td>
</tr>
<tr>
  <td><code>actif</code></td>
  <td>BooleanField</td>
  <td>Default=True</td>
  <td>Statut actif/inactif</td>
</tr>
</tbody>
</table>

<p><strong>Choix <code>type_operateur</code> :</strong>
- <code>CONFIRMATION</code> : Opérateur de Confirmation
- <code>LOGISTIQUE</code> : Opérateur Logistique
- <code>ADMIN</code> : Administrateur</p>

<p><strong>Propriétés :</strong>
- <code>nom_complet</code> : Retourne "prénom nom"
- <code>is_confirmation</code> : True si type<em>operateur == 'CONFIRMATION'
- <code>is_logistique</code> : True si type</em>operateur == 'LOGISTIQUE'
- <code>is_admin</code> : True si type_operateur == 'ADMIN'</p>

<p><strong>Meta :</strong>
- <code>verbose_name</code> : "Opérateur"
- <code>verbose_name_plural</code> : "Opérateurs"
- <code>ordering</code> : ['nom', 'prenom']</p>

<p><strong>Relations :</strong>
- <code>user</code> → <code>User</code> (One-to-One)
- <code>operations</code> ← <code>Operation</code> (One-to-Many)
- <code>etats_modifies</code> ← <code>EtatCommande</code> (One-to-Many)</p>

<hr />

<h2 id="2-application-client">2. Application <code>client</code></h2>

<h3 id="21-modele-client">2.1 Modèle <code>Client</code></h3>

<p><strong>Description :</strong> Gestion des clients</p>

<table>
<thead>
<tr>
  <th>Champ</th>
  <th>Type</th>
  <th>Contraintes</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><code>id</code></td>
  <td>AutoField</td>
  <td>PK, Auto-increment</td>
  <td>Clé primaire automatique</td>
</tr>
<tr>
  <td><code>numero_tel</code></td>
  <td>CharField(20)</td>
  <td>Unique, Required</td>
  <td>Numéro de téléphone</td>
</tr>
<tr>
  <td><code>nom</code></td>
  <td>CharField(100)</td>
  <td>Optional</td>
  <td>Nom de famille</td>
</tr>
<tr>
  <td><code>prenom</code></td>
  <td>CharField(100)</td>
  <td>Optional</td>
  <td>Prénom</td>
</tr>
<tr>
  <td><code>email</code></td>
  <td>EmailField</td>
  <td>Optional</td>
  <td>Adresse email</td>
</tr>
<tr>
  <td><code>adresse</code></td>
  <td>TextField</td>
  <td>Optional</td>
  <td>Adresse complète</td>
</tr>
<tr>
  <td><code>date_creation</code></td>
  <td>DateTimeField</td>
  <td>Auto-now-add</td>
  <td>Date de création</td>
</tr>
<tr>
  <td><code>actif</code></td>
  <td>BooleanField</td>
  <td>Default=True</td>
  <td>Statut actif/inactif</td>
</tr>
</tbody>
</table>

<p><strong>Meta :</strong>
- <code>verbose_name</code> : "Client"
- <code>verbose_name_plural</code> : "Clients"
- <code>ordering</code> : ['numero_tel']</p>

<p><strong>Relations :</strong>
- <code>commandes</code> ← <code>Commande</code> (One-to-Many)</p>

<p><strong>Méthode <code>__str__</code> :</strong>
- Si nom et prénom : "prénom nom - numéro<em>tel"
- Sinon : "Client numéro</em>tel"</p>

<hr />

<h2 id="3-application-article">3. Application <code>article</code></h2>

<h3 id="31-modele-article">3.1 Modèle <code>Article</code></h3>

<p><strong>Description :</strong> Gestion du catalogue d'articles</p>

<table>
<thead>
<tr>
  <th>Champ</th>
  <th>Type</th>
  <th>Contraintes</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><code>id</code></td>
  <td>AutoField</td>
  <td>PK, Auto-increment</td>
  <td>Clé primaire automatique</td>
</tr>
<tr>
  <td><code>nom</code></td>
  <td>CharField(200)</td>
  <td>Required</td>
  <td>Nom de l'article</td>
</tr>
<tr>
  <td><code>couleur</code></td>
  <td>CharField(50)</td>
  <td>Required</td>
  <td>Couleur</td>
</tr>
<tr>
  <td><code>pointure</code></td>
  <td>CharField(10)</td>
  <td>Required</td>
  <td>Pointure/Taille</td>
</tr>
<tr>
  <td><code>prix_unitaire</code></td>
  <td>FloatField</td>
  <td>Required, &gt;0</td>
  <td>Prix unitaire</td>
</tr>
<tr>
  <td><code>categorie</code></td>
  <td>CharField(100)</td>
  <td>Required</td>
  <td>Catégorie</td>
</tr>
<tr>
  <td><code>qte_disponible</code></td>
  <td>IntegerField</td>
  <td>Required, ≥0</td>
  <td>Quantité disponible</td>
</tr>
<tr>
  <td><code>description</code></td>
  <td>TextField</td>
  <td>Optional</td>
  <td>Description détaillée</td>
</tr>
<tr>
  <td><code>image</code></td>
  <td>ImageField</td>
  <td>Optional</td>
  <td>Image de l'article</td>
</tr>
<tr>
  <td><code>date_creation</code></td>
  <td>DateTimeField</td>
  <td>Auto-now-add</td>
  <td>Date de création</td>
</tr>
<tr>
  <td><code>date_modification</code></td>
  <td>DateTimeField</td>
  <td>Auto-now</td>
  <td>Date de modification</td>
</tr>
<tr>
  <td><code>actif</code></td>
  <td>BooleanField</td>
  <td>Default=True</td>
  <td>Statut actif/inactif</td>
</tr>
</tbody>
</table>

<p><strong>Propriétés :</strong>
- <code>est_disponible</code> : True si qte_disponible &gt; 0 et actif == True</p>

<p><strong>Meta :</strong>
- <code>verbose_name</code> : "Article"
- <code>verbose_name_plural</code> : "Articles"
- <code>ordering</code> : ['nom', 'couleur', 'pointure']
- <code>unique_together</code> : ['nom', 'couleur', 'pointure'] (Combinaison unique)</p>

<p><strong>Contraintes :</strong>
- <code>prix_unitaire_positif</code> : prix<em>unitaire &gt; 0
- <code>qte_disponible_positif</code> : qte</em>disponible ≥ 0</p>

<p><strong>Relations :</strong>
- <code>paniers</code> ← <code>Panier</code> (One-to-Many)</p>

<hr />

<h2 id="4-application-commande">4. Application <code>commande</code></h2>

<h3 id="41-modele-enumetatcmd">4.1 Modèle <code>EnumEtatCmd</code></h3>

<p><strong>Description :</strong> États possibles des commandes</p>

<table>
<thead>
<tr>
  <th>Champ</th>
  <th>Type</th>
  <th>Contraintes</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><code>id</code></td>
  <td>AutoField</td>
  <td>PK, Auto-increment</td>
  <td>Clé primaire automatique</td>
</tr>
<tr>
  <td><code>libelle</code></td>
  <td>CharField(100)</td>
  <td>Unique, Required</td>
  <td>Libellé de l'état</td>
</tr>
<tr>
  <td><code>ordre</code></td>
  <td>IntegerField</td>
  <td>Default=0</td>
  <td>Ordre d'affichage</td>
</tr>
<tr>
  <td><code>couleur</code></td>
  <td>CharField(7)</td>
  <td>Default='#6B7280'</td>
  <td>Code couleur hexadécimal</td>
</tr>
</tbody>
</table>

<p><strong>Meta :</strong>
- <code>verbose_name</code> : "État de commande"
- <code>verbose_name_plural</code> : "États de commande"
- <code>ordering</code> : ['ordre', 'libelle']</p>

<p><strong>Relations :</strong>
- <code>etatcommande_set</code> ← <code>EtatCommande</code> (One-to-Many)</p>

<hr />

<h3 id="42-modele-commande">4.2 Modèle <code>Commande</code></h3>

<p><strong>Description :</strong> Commandes principales (États gérés dans EtatCommande)</p>

<table>
<thead>
<tr>
  <th>Champ</th>
  <th>Type</th>
  <th>Contraintes</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><code>id</code></td>
  <td>AutoField</td>
  <td>PK, Auto-increment</td>
  <td>Clé primaire automatique</td>
</tr>
<tr>
  <td><code>num_cmd</code></td>
  <td>CharField(50)</td>
  <td>Unique, Required</td>
  <td>Numéro de commande</td>
</tr>
<tr>
  <td><code>id_yz</code></td>
  <td>CharField(50)</td>
  <td>Optional</td>
  <td>Identifiant YZ</td>
</tr>
<tr>
  <td><code>date_cmd</code></td>
  <td>DateField</td>
  <td>Default=today</td>
  <td>Date de commande</td>
</tr>
<tr>
  <td><code>total_cmd</code></td>
  <td>FloatField</td>
  <td>Required, ≥0</td>
  <td>Montant total</td>
</tr>
<tr>
  <td><code>adresse</code></td>
  <td>TextField</td>
  <td>Required</td>
  <td>Adresse de livraison</td>
</tr>
<tr>
  <td><code>motif_annulation</code></td>
  <td>TextField</td>
  <td>Optional</td>
  <td>Motif d'annulation</td>
</tr>
<tr>
  <td><code>etat_paiement</code></td>
  <td>CharField(20)</td>
  <td>Choices, Default='En attente'</td>
  <td>État du paiement</td>
</tr>
<tr>
  <td><code>is_upsell</code></td>
  <td>BooleanField</td>
  <td>Default=False</td>
  <td>Commande upsell</td>
</tr>
<tr>
  <td><code>date_creation</code></td>
  <td>DateTimeField</td>
  <td>Auto-now-add</td>
  <td>Date de création</td>
</tr>
<tr>
  <td><code>date_modification</code></td>
  <td>DateTimeField</td>
  <td>Auto-now</td>
  <td>Date de modification</td>
</tr>
<tr>
  <td><code>client</code></td>
  <td>ForeignKey(Client)</td>
  <td>CASCADE, Required</td>
  <td>Client</td>
</tr>
<tr>
  <td><code>ville</code></td>
  <td>ForeignKey(Ville)</td>
  <td>CASCADE, Required</td>
  <td>Ville de livraison</td>
</tr>
</tbody>
</table>

<p><strong>Choix <code>etat_paiement</code> :</strong>
- <code>En attente</code> : En attente
- <code>Payé</code> : Payé
- <code>Échoué</code> : Échoué</p>

<p><strong>Propriétés :</strong>
- <code>etat_actuel</code> : Retourne l'état actuel de la commande (EtatCommande sans date_fin)
- <code>historique_etats</code> : Retourne l'historique complet des états</p>

<p><strong>Meta :</strong>
- <code>verbose_name</code> : "Commande"
- <code>verbose_name_plural</code> : "Commandes"
- <code>ordering</code> : ['-date<em>cmd', '-date</em>creation']</p>

<p><strong>Contraintes :</strong>
- <code>total_cmd_positif</code> : total_cmd ≥ 0</p>

<p><strong>Relations :</strong>
- <code>client</code> → <code>Client</code> (Many-to-One)
- <code>ville</code> → <code>Ville</code> (Many-to-One)
- <code>paniers</code> ← <code>Panier</code> (One-to-Many)
- <code>etats</code> ← <code>EtatCommande</code> (One-to-Many)
- <code>operations</code> ← <code>Operation</code> (One-to-Many)</p>

<p><strong>⚠️ Important :</strong> Les états de commande ne sont PAS stockés dans cette table mais dans <code>EtatCommande</code> pour un historique complet.</p>

<hr />

<h3 id="43-modele-panier">4.3 Modèle <code>Panier</code></h3>

<p><strong>Description :</strong> Articles dans une commande</p>

<table>
<thead>
<tr>
  <th>Champ</th>
  <th>Type</th>
  <th>Contraintes</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><code>id</code></td>
  <td>AutoField</td>
  <td>PK, Auto-increment</td>
  <td>Clé primaire automatique</td>
</tr>
<tr>
  <td><code>commande</code></td>
  <td>ForeignKey(Commande)</td>
  <td>CASCADE, Required</td>
  <td>Commande</td>
</tr>
<tr>
  <td><code>article</code></td>
  <td>ForeignKey(Article)</td>
  <td>CASCADE, Required</td>
  <td>Article</td>
</tr>
<tr>
  <td><code>quantite</code></td>
  <td>IntegerField</td>
  <td>Required, &gt;0</td>
  <td>Quantité commandée</td>
</tr>
<tr>
  <td><code>sous_total</code></td>
  <td>FloatField</td>
  <td>Required, ≥0</td>
  <td>Sous-total</td>
</tr>
</tbody>
</table>

<p><strong>Meta :</strong>
- <code>verbose_name</code> : "Panier"
- <code>verbose_name_plural</code> : "Paniers"
- <code>unique_together</code> : [['commande', 'article']] (Un article par commande)</p>

<p><strong>Contraintes :</strong>
- <code>quantite_positive</code> : quantite &gt; 0
- <code>sous_total_positif</code> : sous_total ≥ 0</p>

<p><strong>Relations :</strong>
- <code>commande</code> → <code>Commande</code> (Many-to-One)
- <code>article</code> → <code>Article</code> (Many-to-One)</p>

<hr />

<h3 id="44-modele-etatcommande">4.4 Modèle <code>EtatCommande</code></h3>

<p><strong>Description :</strong> Historique des états des commandes (Table principale pour les modifications d'état)</p>

<table>
<thead>
<tr>
  <th>Champ</th>
  <th>Type</th>
  <th>Contraintes</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><code>id</code></td>
  <td>AutoField</td>
  <td>PK, Auto-increment</td>
  <td>Clé primaire automatique</td>
</tr>
<tr>
  <td><code>commande</code></td>
  <td>ForeignKey(Commande)</td>
  <td>CASCADE, Required</td>
  <td>Commande</td>
</tr>
<tr>
  <td><code>enum_etat</code></td>
  <td>ForeignKey(EnumEtatCmd)</td>
  <td>CASCADE, Required</td>
  <td>État</td>
</tr>
<tr>
  <td><code>date_debut</code></td>
  <td>DateTimeField</td>
  <td>Auto-now-add</td>
  <td>Date de début</td>
</tr>
<tr>
  <td><code>date_fin</code></td>
  <td>DateTimeField</td>
  <td>Optional</td>
  <td>Date de fin</td>
</tr>
<tr>
  <td><code>commentaire</code></td>
  <td>TextField</td>
  <td>Optional</td>
  <td>Commentaire</td>
</tr>
<tr>
  <td><code>operateur</code></td>
  <td>ForeignKey(Operateur)</td>
  <td>CASCADE, Optional</td>
  <td>Opérateur ayant modifié l'état</td>
</tr>
</tbody>
</table>

<p><strong>Méthodes :</strong>
- <code>terminer_etat(operateur=None)</code> : Termine cet état en définissant la date_fin
- <code>duree</code> (property) : Retourne la durée de cet état</p>

<p><strong>Meta :</strong>
- <code>verbose_name</code> : "État de commande"
- <code>verbose_name_plural</code> : "États de commande"
- <code>ordering</code> : ['-date_debut']</p>

<p><strong>Contraintes :</strong>
- <code>date_debut_avant_date_fin</code> : date<em>debut ≤ date</em>fin (si date_fin existe)</p>

<p><strong>Relations :</strong>
- <code>commande</code> → <code>Commande</code> (Many-to-One)
- <code>enum_etat</code> → <code>EnumEtatCmd</code> (Many-to-One)
- <code>operateur</code> → <code>Operateur</code> (Many-to-One)</p>

<p><strong>⚠️ Important :</strong> Cette table est le cœur du système de suivi des commandes. Toutes les modifications d'état sont enregistrées ici.</p>

<hr />

<h3 id="45-modele-operation">4.5 Modèle <code>Operation</code></h3>

<p><strong>Description :</strong> Opérations effectuées sur les commandes</p>

<table>
<thead>
<tr>
  <th>Champ</th>
  <th>Type</th>
  <th>Contraintes</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><code>id</code></td>
  <td>AutoField</td>
  <td>PK, Auto-increment</td>
  <td>Clé primaire automatique</td>
</tr>
<tr>
  <td><code>type_operation</code></td>
  <td>CharField(20)</td>
  <td>Choices, Required</td>
  <td>Type d'opération</td>
</tr>
<tr>
  <td><code>date_operation</code></td>
  <td>DateTimeField</td>
  <td>Auto-now-add</td>
  <td>Date de l'opération</td>
</tr>
<tr>
  <td><code>conclusion</code></td>
  <td>TextField</td>
  <td>Required</td>
  <td>Conclusion/Résultat</td>
</tr>
<tr>
  <td><code>commande</code></td>
  <td>ForeignKey(Commande)</td>
  <td>CASCADE, Required</td>
  <td>Commande</td>
</tr>
<tr>
  <td><code>operateur</code></td>
  <td>ForeignKey(Operateur)</td>
  <td>CASCADE, Required</td>
  <td>Opérateur</td>
</tr>
</tbody>
</table>

<p><strong>Choix <code>type_operation</code> :</strong>
- <code>CONFIRMATION</code> : Confirmation
- <code>ANNULATION</code> : Annulation
- <code>PREPARATION</code> : Préparation
- <code>EXPEDITION</code> : Expédition
- <code>LIVRAISON</code> : Livraison
- <code>RETOUR</code> : Retour
- <code>MODIFICATION</code> : Modification
- <code>COMMENTAIRE</code> : Commentaire</p>

<p><strong>Meta :</strong>
- <code>verbose_name</code> : "Opération"
- <code>verbose_name_plural</code> : "Opérations"
- <code>ordering</code> : ['-date_operation']</p>

<p><strong>Relations :</strong>
- <code>commande</code> → <code>Commande</code> (Many-to-One)
- <code>operateur</code> → <code>Operateur</code> (Many-to-One)</p>

<hr />

<h2 id="5-diagramme-des-relations">5. Diagramme des Relations</h2>

<pre><code>User (Django) ←→ Operateur
                     ↓
Client → Commande ← Ville ← Region
           ↓
        Panier → Article
           ↓
     EtatCommande ← EnumEtatCmd
           ↓        ↑
       Operation    Operateur
</code></pre>

<hr />

<h2 id="6-contraintes-et-validations">6. Contraintes et Validations</h2>

<h3 id="contraintes-de-base-de-donnees">Contraintes de Base de Données</h3>

<ul>
<li><strong>Unicité</strong> : Region.nom<em>region, Ville(nom+region), Client.numero</em>tel, Article(nom+couleur+pointure), Commande.num_cmd, EnumEtatCmd.libelle</li>
<li><strong>Valeurs positives</strong> : Article.prix<em>unitaire &gt; 0, Article.qte</em>disponible ≥ 0, Commande.total<em>cmd ≥ 0, Panier.quantite &gt; 0, Panier.sous</em>total ≥ 0</li>
<li><strong>Dates cohérentes</strong> : EtatCommande.date<em>debut ≤ date</em>fin</li>
</ul>

<h3 id="validations-metier">Validations Métier</h3>

<ul>
<li>Un article est disponible si qte_disponible &gt; 0 ET actif = True</li>
<li>Un opérateur a un type unique (CONFIRMATION, LOGISTIQUE, ADMIN)</li>
<li>Une commande peut avoir plusieurs états dans le temps</li>
<li>L'état actuel d'une commande est celui sans date_fin dans EtatCommande</li>
<li>Toutes les modifications d'état sont tracées dans EtatCommande avec l'opérateur responsable</li>
</ul>

<hr />

<h2 id="7-signaux-django">7. Signaux Django</h2>

<h3 id="signal-post_save-sur-user">Signal <code>post_save</code> sur User</h3>

<p><strong>Fichier :</strong> <code>parametre/signals.py</code>
<strong>Fonction :</strong> Création automatique du profil Operateur selon les groupes de l'utilisateur
<strong>Logique :</strong>
- Si utilisateur dans groupe "Administrateurs" → type<em>operateur = 'ADMIN'
- Si utilisateur dans groupe "Operateurs</em>Confirmation" → type<em>operateur = 'CONFIRMATION'<br />
- Si utilisateur dans groupe "Operateurs</em>Logistique" → type_operateur = 'LOGISTIQUE'
- Synchronisation des données User ↔ Operateur</p>

<hr />

<h2 id="8-interface-dadministration">8. Interface d'Administration</h2>

<h3 id="fonctionnalites-admin">Fonctionnalités Admin</h3>

<ul>
<li><strong>Filtres avancés</strong> par type, statut, dates</li>
<li><strong>Recherche</strong> sur tous les champs pertinents</li>
<li><strong>Édition en ligne</strong> pour les champs fréquemment modifiés</li>
<li><strong>Fieldsets organisés</strong> pour une meilleure UX</li>
<li><strong>Relations inline</strong> pour les modèles liés</li>
<li><strong>Champs en lecture seule</strong> pour les données système</li>
</ul>

<h3 id="permissions">Permissions</h3>

<ul>
<li>Accès différencié selon le type d'opérateur</li>
<li>Interface spécialisée pour chaque rôle</li>
<li>Sidebar personnalisée avec couleurs thématiques</li>
</ul>

<hr />

<h2 id="9-donnees-importees">9. Données Importées</h2>

<h3 id="regions-et-villes">Régions et Villes</h3>

<ul>
<li><strong>11 régions</strong> : CASABLANCA, SALE, MARRAKECH, AGADIR, TETOUAN, OUJDA, SAFI, MEKNÈS, BENI MELLAL, FÈS, GUELMIM</li>
<li><strong>416 villes</strong> avec tarifs de livraison et fréquences</li>
<li><strong>Tarifs</strong> : de 20DH (grandes villes) à 50DH (zones éloignées)</li>
</ul>

<h3 id="articles">Articles</h3>

<ul>
<li><strong>Chaussures femme</strong> principalement (SAB FEM YZ83, SAB FEM YZ 410)</li>
<li><strong>Couleurs</strong> : NOIR, BEIGE, MARRON, BLEU MARINE, BLEU CIEL, CAMEL</li>
<li><strong>Pointures</strong> : 37 à 41</li>
<li><strong>Prix</strong> : de 200DH à 700DH selon le modèle et la pointure</li>
</ul>

<hr />

<p><em>Documentation générée par COD$uite Team - Version 1.0</em>
<em>Projet YZ-CMD - Système de Gestion de Commandes</em> </p>

    </body>
    </html>
    